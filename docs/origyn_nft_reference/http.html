<!DOCTYPE html>
<html><head title="Doc"><meta charset="UTF-8"/><link href="../styles.css" rel="stylesheet"/></head><body><nav class="sidebar"><h3>Modules</h3><ul><li><li><a href="../origyn_nft_reference/DIP721.html">origyn_nft_reference/DIP721</a></li></li><li><li><a href="../origyn_nft_reference/data.html">origyn_nft_reference/data</a></li></li><li><li><a href="../origyn_nft_reference/dfxtypes.html">origyn_nft_reference/dfxtypes</a></li></li><li><li><a href="../origyn_nft_reference/governance.html">origyn_nft_reference/governance</a></li></li><li><li><a href="../origyn_nft_reference/http.html">origyn_nft_reference/http</a></li></li><li><li><a href="../origyn_nft_reference/kyc.html">origyn_nft_reference/kyc</a></li></li><li><li><a href="../origyn_nft_reference/ledger_interface.html">origyn_nft_reference/ledger_interface</a></li></li><li><li><a href="../origyn_nft_reference/main.html">origyn_nft_reference/main</a></li></li><li><li><a href="../origyn_nft_reference/market.html">origyn_nft_reference/market</a></li></li><li><li><a href="../origyn_nft_reference/metadata.html">origyn_nft_reference/metadata</a></li></li><li><li><a href="../origyn_nft_reference/migrations/lib.html">origyn_nft_reference/migrations/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations/types.html">origyn_nft_reference/migrations/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_000_000/lib.html">origyn_nft_reference/migrations/v000_000_000/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_000_000/types.html">origyn_nft_reference/migrations/v000_000_000/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_001_000/lib.html">origyn_nft_reference/migrations/v000_001_000/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_001_000/types.html">origyn_nft_reference/migrations/v000_001_000/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_001_003/lib.html">origyn_nft_reference/migrations/v000_001_003/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_001_003/types.html">origyn_nft_reference/migrations/v000_001_003/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_001_004/lib.html">origyn_nft_reference/migrations/v000_001_004/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations/v000_001_004/types.html">origyn_nft_reference/migrations/v000_001_004/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/lib.html">origyn_nft_reference/migrations_storage/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/types.html">origyn_nft_reference/migrations_storage/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/v000_001_000/lib.html">origyn_nft_reference/migrations_storage/v000_001_000/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/v000_001_000/types.html">origyn_nft_reference/migrations_storage/v000_001_000/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/v000_001_003/lib.html">origyn_nft_reference/migrations_storage/v000_001_003/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/v000_001_003/types.html">origyn_nft_reference/migrations_storage/v000_001_003/types</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/v000_001_004/lib.html">origyn_nft_reference/migrations_storage/v000_001_004/lib</a></li></li><li><li><a href="../origyn_nft_reference/migrations_storage/v000_001_004/types.html">origyn_nft_reference/migrations_storage/v000_001_004/types</a></li></li><li><li><a href="../origyn_nft_reference/mint.html">origyn_nft_reference/mint</a></li></li><li><li><a href="../origyn_nft_reference/owner.html">origyn_nft_reference/owner</a></li></li><li><li><a href="../origyn_nft_reference/storage_http.html">origyn_nft_reference/storage_http</a></li></li><li><li><a href="../origyn_nft_reference/storage_store.html">origyn_nft_reference/storage_store</a></li></li><li><li><a href="../origyn_nft_reference/types.html">origyn_nft_reference/types</a></li></li><li><li><a href="../origyn_nft_reference/utils.html">origyn_nft_reference/utils</a></li></li><li><li><a href="../origyn_sale_reference/main.html">origyn_sale_reference/main</a></li></li><li><li><a href="../origyn_sale_reference/types.html">origyn_sale_reference/types</a></li></li><li><li><a href="../origyn_storage_reference/storage_canister.html">origyn_storage_reference/storage_canister</a></li></li><li><li><a href="../tests/all_ref.html">tests/all_ref</a></li></li><li><li><a href="../tests/canister_creator.html">tests/canister_creator</a></li></li><li><li><a href="../tests/storage_creator.html">tests/storage_creator</a></li></li><li><li><a href="../tests/test_runner.html">tests/test_runner</a></li></li><li><li><a href="../tests/test_runner_collection.html">tests/test_runner_collection</a></li></li><li><li><a href="../tests/test_runner_data.html">tests/test_runner_data</a></li></li><li><li><a href="../tests/test_runner_instant_transfer.html">tests/test_runner_instant_transfer</a></li></li><li><li><a href="../tests/test_runner_nft.html">tests/test_runner_nft</a></li></li><li><li><a href="../tests/test_runner_nft_2.html">tests/test_runner_nft_2</a></li></li><li><li><a href="../tests/test_runner_sale.html">tests/test_runner_sale</a></li></li><li><li><a href="../tests/test_runner_storage.html">tests/test_runner_storage</a></li></li><li><li><a href="../tests/test_runner_utils.html">tests/test_runner_utils</a></li></li><li><li><a href="../tests/test_utils.html">tests/test_utils</a></li></li><li><li><a href="../tests/test_wallet.html">tests/test_wallet</a></li></li></ul><h3>Declarations</h3><ul><li><li><a href="#type.HTTPResponse">HTTPResponse</a></li></li><li><li><a href="#type.StreamingStrategy">StreamingStrategy</a></li></li><li><li><a href="#type.StreamingCallbackToken">StreamingCallbackToken</a></li></li><li><li><a href="#type.StreamingCallbackResponse">StreamingCallbackResponse</a></li></li><li><li><a href="#type.HttpRequest">HttpRequest</a></li></li><li><li><a href="#gen_access_key">gen_access_key</a></li></li><li><li><a href="#handle_stream_content">handle_stream_content</a></li></li><li><li><a href="#handleLargeContent">handleLargeContent</a></li></li><li><li><a href="#_stream_media">_stream_media</a></li></li><li><li><a href="#_stream_content">_stream_content</a></li></li><li><li><a href="#stream_media">stream_media</a></li></li><li><li><a href="#handle_range_headers">handle_range_headers</a></li></li><li><li><a href="#renderLibrary">renderLibrary</a></li></li><li><li><a href="#renderSmartRoute">renderSmartRoute</a></li></li><li><li><a href="#nftStreamingCallback">nftStreamingCallback</a></li></li><li><li><a href="#http_request_streaming_callback">http_request_streaming_callback</a></li></li><li><li><a href="#json">json</a></li></li><li><li><a href="#splitQuery">splitQuery</a></li></li><li><li><a href="#get_deep_properties">get_deep_properties</a></li></li><li><li><a href="#split_text">split_text</a></li></li><li><li><a href="#http_owner_check">http_owner_check</a></li></li><li><li><a href="#http_nft_owner_check">http_nft_owner_check</a></li></li><li><li><a href="#http_request">http_request</a></li></li></ul></nav><div class="documentation"><h1>origyn_nft_reference/http</h1><div class="declaration"><h4 class="type-declaration" id="type.HTTPResponse"><span class="keyword">type </span><span class="type">HTTPResponse</span> = { body : <span class="type">Blob</span>; headers : [<span class="type">http.HeaderField</span>]; status_code : <span class="type">Nat16</span>; streaming_strategy : ?<a href="#type.StreamingStrategy"><span class="type">StreamingStrategy</span></a> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.StreamingStrategy"><span class="keyword">type </span><span class="type">StreamingStrategy</span> = {#Callback : { callback : <span class="keyword">shared </span>() -&gt; <span class="keyword">async </span>(); token : <a href="#type.StreamingCallbackToken"><span class="type">StreamingCallbackToken</span></a> }}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.StreamingCallbackToken"><span class="keyword">type </span><span class="type">StreamingCallbackToken</span> = { content_encoding : <span class="type">Text</span>; index : <span class="type">Nat</span>; key : <span class="type">Text</span> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.StreamingCallbackResponse"><span class="keyword">type </span><span class="type">StreamingCallbackResponse</span> = { body : <span class="type">Blob</span>; token : ?<a href="#type.StreamingCallbackToken"><span class="type">StreamingCallbackToken</span></a> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.HttpRequest"><span class="keyword">type </span><span class="type">HttpRequest</span> = { body : <span class="type">Blob</span>; headers : [<span class="type">http.HeaderField</span>]; method : <span class="type">Text</span>; url : <span class="type">Text</span> }</h4><p></p></div><div class="declaration"><h4 class="function" id="gen_access_key"><code><span class="keyword">public func </span><span class="fnname">gen_access_key</span>() : <span class="keyword">async* </span><span class="type">Text</span></code></h4><p><ul><li>Generates an access key by generating a random string of characters.<ul><li>@returns {Async&lt;Text&gt;} - Returns an AsyncIterable that yields a random string of characters as a Text object.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="handle_stream_content"><code><span class="keyword">public func </span><span class="fnname">handle_stream_content</span>(<br/>  <span class="parameter">state</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>, <br/>  <span class="parameter">token_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">library_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">start</span> : ?<span class="type">Nat</span>, <br/>  <span class="parameter">end</span> : ?<span class="type">Nat</span>, <br/>  <span class="parameter">contentType</span> : <span class="type">Text</span>, <br/>  <span class="parameter">data</span> : <span class="type">CandyTypes.Workspace</span>, <br/>  <span class="parameter">req</span> : <span class="type">httpparser.ParsedHttpRequest</span><br/>) : <a href="#type.HTTPResponse"><span class="type">HTTPResponse</span></a></code></h4><p><ul><li>Handles streaming content for an NFT
 *<ul><li>@param {Types.State} state - The current state of the canister</li><li>@param {Text} token_id - The ID of the token being streamed</li><li>@param {Text} library_id - The ID of the library containing the token</li><li>@param {Nat | null} start - The starting byte position of the streaming content</li><li>@param {Nat | null} end - The ending byte position of the streaming content</li><li>@param {Text} contentType - The content type of the streaming content</li><li>@param {CandyTypes.Workspace} data - The workspace containing the streaming content</li><li>@param {httpparser.ParsedHttpRequest} req - The parsed HTTP request</li><li></li><li>@returns {HTTPResponse} - The HTTP response containing the streaming content</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="handleLargeContent"><code><span class="keyword">public func </span><span class="fnname">handleLargeContent</span>(<br/>  <span class="parameter">state</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>, <br/>  <span class="parameter">key</span> : <span class="type">Text</span>, <br/>  <span class="parameter">contentType</span> : <span class="type">Text</span>, <br/>  <span class="parameter">data</span> : <span class="type">CandyTypes.Workspace</span>, <br/>  <span class="parameter">req</span> : <span class="type">httpparser.ParsedHttpRequest</span><br/>) : <a href="#type.HTTPResponse"><span class="type">HTTPResponse</span></a></code></h4><p><ul><li>Handles non-streaming large content<ul><li>@param {Types.State} state - The current state</li><li>@param {string} key - The key of the content to handle</li><li>@param {string} contentType - The content type of the content</li><li>@param {CandyTypes.Workspace} data - The workspace containing the content</li><li>@param {httpparser.ParsedHttpRequest} req - The parsed HTTP request</li><li>@returns {HTTPResponse} - The response containing the content</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="_stream_media"><code><span class="keyword">public func </span><span class="fnname">_stream_media</span>(<br/>  <span class="parameter">token_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">library_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">index</span> : <span class="type">Nat</span>, <br/>  <span class="parameter">data</span> : <span class="type">CandyTypes.Workspace</span>, <br/>  <span class="parameter">rStart</span> : <span class="type">Nat</span>, <br/>  <span class="parameter">rEnd</span> : <span class="type">Nat</span>, <br/>  <span class="parameter">size</span> : <span class="type">Nat</span><br/>) : { payload : <span class="type">Blob</span>; callback : ?<a href="#type.StreamingCallbackToken"><span class="type">StreamingCallbackToken</span></a> }</code></h4><p><ul><li>Streams the media content for a specific NFT.
 *<ul><li>@param {Text} token_id - The ID of the NFT.</li><li>@param {Text} library_id - The ID of the library containing the NFT.</li><li>@param {Nat} index - The starting index for the media content.</li><li>@param {CandyTypes.Workspace} data - The workspace data containing the media content.</li><li>@param {Nat} rStart - The starting range for the media content.</li><li>@param {Nat} rEnd - The ending range for the media content.</li><li>@param {Nat} size - The size of the media content.</li><li>@returns {{payload: Blob, callback: ?StreamingCallbackToken}} - An object containing the payload and callback token for the media content.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="_stream_content"><code><span class="keyword">public func </span><span class="fnname">_stream_content</span>(<br/>  <span class="parameter">key</span> : <span class="type">Text</span>, <br/>  <span class="parameter">index</span> : <span class="type">Nat</span>, <br/>  <span class="parameter">data</span> : <span class="type">CandyTypes.Workspace</span>, <br/>  <span class="parameter">use_stable</span> : <span class="type">Bool</span><br/>) : { payload : <span class="type">Blob</span>; callback : ?<a href="#type.StreamingCallbackToken"><span class="type">StreamingCallbackToken</span></a> }</code></h4><p><ul><li>Streams content for a specified key.
 *<ul><li>@param {Text} key - The key for the content to be streamed.</li><li>@param {Nat} index - The starting index for the content.</li><li>@param {CandyTypes.Workspace} data - The workspace data containing the content.</li><li>@param {Bool} use_stable - Whether or not to use the stable memory.</li><li>@param {Types.Stable_Memory} btreemap - The stable memory to use.</li><li>@returns {{payload: Blob, callback: ?StreamingCallbackToken}} - An object containing the payload and callback token for the content.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="stream_media"><code><span class="keyword">public func </span><span class="fnname">stream_media</span>(<br/>  <span class="parameter">token_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">library_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">index</span> : <span class="type">Nat</span>, <br/>  <span class="parameter">data</span> : <span class="type">CandyTypes.Workspace</span>, <br/>  <span class="parameter">rStart</span> : <span class="type">Nat</span>, <br/>  <span class="parameter">rEnd</span> : <span class="type">Nat</span>, <br/>  <span class="parameter">size</span> : <span class="type">Nat</span><br/>) : <a href="#type.StreamingCallbackResponse"><span class="type">StreamingCallbackResponse</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="handle_range_headers"><code><span class="keyword">public func </span><span class="fnname">handle_range_headers</span>(<span class="parameter">headers</span> : [<span class="type">http.HeaderField</span>]) : { start : ?<span class="type">Nat</span>; end : ?<span class="type">Nat</span>; b_foundRange : <span class="type">Bool</span> }</code></h4><p><ul><li>Handles the range headers from an HTTP request and returns the start and end values, if present<ul><li>@param headers - the headers from the HTTP request</li><li>@returns an object containing the start and end values and a boolean indicating whether a range header was found</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="renderLibrary"><code><span class="keyword">public func </span><span class="fnname">renderLibrary</span>(<br/>  <span class="parameter">state</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>, <br/>  <span class="parameter">req</span> : <span class="type">httpparser.ParsedHttpRequest</span>, <br/>  <span class="parameter">metadata</span> : <span class="type">CandyTypes.CandyShared</span>, <br/>  <span class="parameter">token_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">library_id</span> : <span class="type">Text</span><br/>) : <a href="#type.HTTPResponse"><span class="type">HTTPResponse</span></a></code></h4><p><ul><li>Determines how a library item should be rendered in an HTTP request.<ul><li>@param {Types.State} state - The state of the canister.</li><li>@param {httpparser.ParsedHttpRequest} req - The HTTP request.</li><li>@param {CandyTypes.CandyShared} metadata - The metadata for the NFT.</li><li>@param {string} token_id - The ID of the token.</li><li>@param {string} library_id - The ID of the library.</li><li>@returns</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="renderSmartRoute"><code><span class="keyword">public func </span><span class="fnname">renderSmartRoute</span>(<br/>  <span class="parameter">state</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>, <br/>  <span class="parameter">req</span> : <span class="type">httpparser.ParsedHttpRequest</span>, <br/>  <span class="parameter">metadata</span> : <span class="type">CandyTypes.CandyShared</span>, <br/>  <span class="parameter">token_id</span> : <span class="type">Text</span>, <br/>  <span class="parameter">smartRoute</span> : <span class="type">Text</span><br/>) : <a href="#type.HTTPResponse"><span class="type">HTTPResponse</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="nftStreamingCallback"><code><span class="keyword">public func </span><span class="fnname">nftStreamingCallback</span>(<span class="parameter">tk</span> : <a href="#type.StreamingCallbackToken"><span class="type">StreamingCallbackToken</span></a>, <span class="parameter">state</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>) : <a href="#type.StreamingCallbackResponse"><span class="type">StreamingCallbackResponse</span></a></code></h4><p><ul><li>Callback function used for NFT streaming. Handles streaming NFT content<ul><li>@param tk - StreamingCallbackToken, token containing streaming info</li><li>@param state - Types.State, state object containing library data and other metadata</li><li>@returns StreamingCallbackResponse object, containing payload and streaming token</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="http_request_streaming_callback"><code><span class="keyword">public func </span><span class="fnname">http_request_streaming_callback</span>(<span class="parameter">tk</span> : <a href="#type.StreamingCallbackToken"><span class="type">StreamingCallbackToken</span></a>, <span class="parameter">state</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>) : <a href="#type.StreamingCallbackResponse"><span class="type">StreamingCallbackResponse</span></a></code></h4><p><ul><li>Callback function for streaming large content over HTTP.<ul><li>Determines how a library item should be rendered in an HTTP request.
 *</li><li>@param {StreamingCallbackToken} tk - Token representing the current streaming session.</li><li>@param {Types.State} state - State object containing the current allocation and other relevant data.</li><li>@returns {StreamingCallbackResponse} - A response object containing the payload and callback for the next chunk (if applicable).</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="json"><code><span class="keyword">public func </span><span class="fnname">json</span>(<span class="parameter">message</span> : <span class="type">CandyTypes.CandyShared</span>, <span class="parameter">_query</span> : ?<span class="type">Text</span>) : <a href="#type.HTTPResponse"><span class="type">HTTPResponse</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="splitQuery"><code><span class="keyword">public func </span><span class="fnname">splitQuery</span>(<span class="parameter">q</span> : <span class="type">Text</span>, <span class="parameter">p</span> : <span class="type">Char</span>) : <span class="type">Result.Result</span>&lt;<span class="type">List.List</span>&lt;<a href="#type.sQuery"><span class="type">sQuery</span></a>&gt;, <span class="type">Text</span>&gt;</code></h4><p><ul><li>Splits a query string into a list of sQueries.<ul><li>@param {Text} q - The query string to split.</li><li>@param {Char} p - The character used to separate sQueries.</li><li>@returns {Result.Result&lt;List.List&lt;sQuery&gt;, Text&gt;} - A Result containing a list of sQueries or an error message.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="get_deep_properties"><code><span class="keyword">public func </span><span class="fnname">get_deep_properties</span>(<span class="parameter">metadata</span> : <span class="type">CandyTypes.CandyShared</span>, <span class="parameter">qs</span> : <span class="type">List.List</span>&lt;<a href="#type.sQuery"><span class="type">sQuery</span></a>&gt;) : {#ok : <span class="type">CandyTypes.CandyShared</span>; #err; #back}</code></h4><p></p></div><div class="declaration"><h4 class="function" id="split_text"><code><span class="keyword">public func </span><span class="fnname">split_text</span>(<span class="parameter">q</span> : <span class="type">Text</span>, <span class="parameter">p</span> : <span class="type">Char</span>) : [<span class="type">Text</span>]</code></h4><p></p></div><div class="declaration"><h4 class="function" id="http_owner_check"><code><span class="keyword">public func </span><span class="fnname">http_owner_check</span>(<span class="parameter">stateBody</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>, <span class="parameter">req</span> : <span class="type">httpparser.ParsedHttpRequest</span>) : <span class="type">Result.Result</span>&lt;(), <span class="type">Text</span>&gt;</code></h4><p></p></div><div class="declaration"><h4 class="function" id="http_nft_owner_check"><code><span class="keyword">public func </span><span class="fnname">http_nft_owner_check</span>(<br/>  <span class="parameter">stateBody</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>, <br/>  <span class="parameter">req</span> : <span class="type">httpparser.ParsedHttpRequest</span>, <br/>  <span class="parameter">metadata</span> : <span class="type">CandyTypes.CandyShared</span><br/>) : <span class="type">Result.Result</span>&lt;(), <span class="type">Text</span>&gt;</code></h4><p></p></div><div class="declaration"><h4 class="function" id="http_request"><code><span class="keyword">public func </span><span class="fnname">http_request</span>(<br/>  <span class="parameter">state</span> : <a href="types.html#type.State"><span class="type">Types.State</span></a>, <br/>  <span class="parameter">rawReq</span> : <a href="#type.HttpRequest"><span class="type">HttpRequest</span></a>, <br/>  <span class="parameter">caller</span> : <span class="type">Principal</span><br/>) : (<a href="#type.HTTPResponse"><span class="type">HTTPResponse</span></a>)</code></h4><p></p></div></div></body></html>